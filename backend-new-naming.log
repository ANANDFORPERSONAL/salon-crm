ğŸš€ Starting Ease My Salon Backend Server...
ğŸŒ Environment: development
ğŸ”— CORS Origins: [ 'http://localhost:3000', 'http://127.0.0.1:3000' ]
ğŸ—„ï¸ MongoDB URI: Not set
ğŸ”‘ JWT Secret: Not set
(node:48325) [MONGOOSE] Warning: Duplicate schema index on {"phone":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
ğŸš€ Ease My Salon Backend running on port 3001
ğŸ“Š Health check: http://localhost:3001/api/health
ğŸ” API Base: http://localhost:3001/api
â° Inactivity checker scheduled to run daily at 2 AM IST
MongoDB Connected: localhost
ğŸ“¥ Incoming POST /api/admin/login
ğŸ”— Connecting to main database: ease_my_salon_main
âœ… Connected to main database: ease_my_salon_main
ğŸ” Admin login attempt: { email: 'admin@easemysalon.in' }
ğŸ” Looking for admin with email: admin@easemysalon.in
âœ… Admin found: {
  id: new ObjectId('6913a9dd45496f244d9d46fb'),
  email: 'admin@easemysalon.in',
  role: 'super_admin'
}
âœ… Password validated successfully
127.0.0.1 - - [12/Nov/2025:04:59:56 +0000] "POST /api/admin/login HTTP/1.1" 200 887 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/admin/dashboard/stats
127.0.0.1 - - [12/Nov/2025:04:59:56 +0000] "GET /api/admin/dashboard/stats HTTP/1.1" 200 3115 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/admin/dashboard/stats
127.0.0.1 - - [12/Nov/2025:04:59:56 +0000] "GET /api/admin/dashboard/stats HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming POST /api/auth/login
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "POST /api/auth/login HTTP/1.1" 200 2416 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/settings/business
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/reports/dashboard
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/sales
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ”— Connecting to business database: salon_crm_BIZ0002 (legacy by code - backward compatible)
âœ… Connected to business database: salon_crm_BIZ0002
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Business settings request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ”— Connecting to business database: salon_crm_BIZ0002 (legacy by code - backward compatible)
âœ… Connected to business database: salon_crm_BIZ0002
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Dashboard stats request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ”— Connecting to business database: salon_crm_BIZ0002 (legacy by code - backward compatible)
âœ… Connected to business database: salon_crm_BIZ0002
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ”— Connecting to business database: salon_crm_BIZ0002 (legacy by code - backward compatible)
âœ… Connected to business database: salon_crm_BIZ0002
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ”— Connecting to business database: salon_crm_BIZ0002 (legacy by code - backward compatible)
âœ… Connected to business database: salon_crm_BIZ0002
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ”— Connecting to business database: salon_crm_BIZ0002 (legacy by code - backward compatible)
âœ… Connected to business database: salon_crm_BIZ0002
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Sales request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/appointments?limit=500 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Total services: 0
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/appointments?limit=200&date=2025-11-12 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Total products: 0
ğŸ“¥ Incoming GET /api/settings/payment
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
Total staff: 0
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/appointments?limit=5 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/products
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
Total clients: 0
ğŸ“¥ Incoming GET /api/services
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
Total appointments: 0
âœ… Sales found: 0
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/sales HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
Total receipts: 0
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Products request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
Total revenue: 0
âœ… Dashboard stats calculated for business: new ObjectId('6913bc5770f5bc2f8957d21a')
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/reports/dashboard HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Services request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“ No business settings found, creating default settings...
Get payment settings error: Error: BusinessSettings validation failed: phone: Path `phone` is required., address: Path `address` is required., city: Path `city` is required., state: Path `state` is required., zipCode: Path `zipCode` is required.
    at ValidationError.inspect (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/error/validation.js:52:26)
    at formatValue (node:internal/util/inspect:887:19)
    at inspect (node:internal/util/inspect:409:10)
    at formatWithOptionsInternal (node:internal/util/inspect:2574:40)
    at formatWithOptions (node:internal/util/inspect:2436:10)
    at console.value (node:internal/console/constructor:345:14)
    at console.error (node:internal/console/constructor:412:61)
    at /Users/shubhamanand/salon-crm/backend/server.js:5002:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  errors: {
    phone: ValidatorError: Path `phone` is required.
        at validate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1407:13)
        at SchemaType.doValidate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1391:7)
        at /Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/document.js:3111:18
        at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {
      properties: [Object],
      kind: 'required',
      path: 'phone',
      value: '',
      reason: undefined,
      Symbol(mongoose#validatorError): true
    },
    address: ValidatorError: Path `address` is required.
        at validate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1407:13)
        at SchemaType.doValidate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1391:7)
        at /Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/document.js:3111:18
        at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {
      properties: [Object],
      kind: 'required',
      path: 'address',
      value: '',
      reason: undefined,
      Symbol(mongoose#validatorError): true
    },
    city: ValidatorError: Path `city` is required.
        at validate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1407:13)
        at SchemaType.doValidate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1391:7)
        at /Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/document.js:3111:18
        at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {
      properties: [Object],
      kind: 'required',
      path: 'city',
      value: '',
      reason: undefined,
      Symbol(mongoose#validatorError): true
    },
    state: ValidatorError: Path `state` is required.
        at validate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1407:13)
        at SchemaType.doValidate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1391:7)
        at /Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/document.js:3111:18
        at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {
      properties: [Object],
      kind: 'required',
      path: 'state',
      value: '',
      reason: undefined,
      Symbol(mongoose#validatorError): true
    },
    zipCode: ValidatorError: Path `zipCode` is required.
        at validate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1407:13)
        at SchemaType.doValidate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1391:7)
        at /Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/document.js:3111:18
        at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {
      properties: [Object],
      kind: 'required',
      path: 'zipCode',
      value: '',
      reason: undefined,
      Symbol(mongoose#validatorError): true
    }
  },
  _message: 'BusinessSettings validation failed'
}
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/settings/payment HTTP/1.1" 500 49 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
âœ… Products found: 0
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/products?limit=1000 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
âœ… Services found: 0
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/services?limit=1000 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/sales
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“¥ Incoming GET /api/reports/dashboard
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/appointments?limit=500 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“¥ Incoming GET /api/settings/payment
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/appointments?limit=5 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Dashboard stats request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Sales request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
Total services: 0
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/appointments?limit=200&date=2025-11-12 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/products
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
âœ… Sales found: 0
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/sales HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Total products: 0
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ“¥ Incoming GET /api/services
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“¥ Incoming GET /api/sales
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
Total staff: 0
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Products request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“ No business settings found, creating default settings...
Get payment settings error: Error: BusinessSettings validation failed: phone: Path `phone` is required., address: Path `address` is required., city: Path `city` is required., state: Path `state` is required., zipCode: Path `zipCode` is required.
    at ValidationError.inspect (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/error/validation.js:52:26)
    at formatValue (node:internal/util/inspect:887:19)
    at inspect (node:internal/util/inspect:409:10)
    at formatWithOptionsInternal (node:internal/util/inspect:2574:40)
    at formatWithOptions (node:internal/util/inspect:2436:10)
    at console.value (node:internal/console/constructor:345:14)
    at console.error (node:internal/console/constructor:412:61)
    at /Users/shubhamanand/salon-crm/backend/server.js:5002:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  errors: {
    phone: ValidatorError: Path `phone` is required.
        at validate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1407:13)
        at SchemaType.doValidate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1391:7)
        at /Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/document.js:3111:18
        at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {
      properties: [Object],
      kind: 'required',
      path: 'phone',
      value: '',
      reason: undefined,
      Symbol(mongoose#validatorError): true
    },
    address: ValidatorError: Path `address` is required.
        at validate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1407:13)
        at SchemaType.doValidate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1391:7)
        at /Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/document.js:3111:18
        at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {
      properties: [Object],
      kind: 'required',
      path: 'address',
      value: '',
      reason: undefined,
      Symbol(mongoose#validatorError): true
    },
    city: ValidatorError: Path `city` is required.
        at validate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1407:13)
        at SchemaType.doValidate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1391:7)
        at /Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/document.js:3111:18
        at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {
      properties: [Object],
      kind: 'required',
      path: 'city',
      value: '',
      reason: undefined,
      Symbol(mongoose#validatorError): true
    },
    state: ValidatorError: Path `state` is required.
        at validate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1407:13)
        at SchemaType.doValidate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1391:7)
        at /Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/document.js:3111:18
        at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {
      properties: [Object],
      kind: 'required',
      path: 'state',
      value: '',
      reason: undefined,
      Symbol(mongoose#validatorError): true
    },
    zipCode: ValidatorError: Path `zipCode` is required.
        at validate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1407:13)
        at SchemaType.doValidate (/Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/schemaType.js:1391:7)
        at /Users/shubhamanand/salon-crm/backend/node_modules/mongoose/lib/document.js:3111:18
        at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {
      properties: [Object],
      kind: 'required',
      path: 'zipCode',
      value: '',
      reason: undefined,
      Symbol(mongoose#validatorError): true
    }
  },
  _message: 'BusinessSettings validation failed'
}
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/settings/payment HTTP/1.1" 500 49 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Total clients: 0
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Services request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
Total appointments: 0
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Sales request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
Total receipts: 0
âœ… Products found: 0
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/products?limit=1000 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
âœ… Sales found: 0
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/sales HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Total revenue: 0
âœ… Dashboard stats calculated for business: new ObjectId('6913bc5770f5bc2f8957d21a')
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/reports/dashboard HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
âœ… Services found: 0
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/services?limit=1000 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/sales
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Sales request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
âœ… Sales found: 0
127.0.0.1 - - [12/Nov/2025:05:00:39 +0000] "GET /api/sales HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
âœ… Business settings found: Glamour Salon & Spa
127.0.0.1 - - [12/Nov/2025:05:00:40 +0000] "GET /api/settings/business HTTP/1.1" 200 1006 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/settings/business
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Business settings request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
âœ… Business settings found: Glamour Salon & Spa
127.0.0.1 - - [12/Nov/2025:05:00:40 +0000] "GET /api/settings/business HTTP/1.1" 200 1006 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/admin/profile
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/admin/profile HTTP/1.1" 200 714 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/auth/profile
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Profile endpoint - req.user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  _id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/auth/profile HTTP/1.1" 200 441 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/reports/dashboard
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/sales
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/settings/business
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/settings/payment
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Dashboard stats request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Sales request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Business settings request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/settings/payment HTTP/1.1" 200 656 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
âœ… Business settings found: Glamour Salon & Spa
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/settings/business HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
âœ… Sales found: 0
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/sales HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
Total services: 0
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/services
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/products
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
Total products: 0
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/appointments?limit=200&date=2025-11-12 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
Total staff: 0
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/appointments?limit=500 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“¥ Incoming GET /api/settings/payment
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
Total clients: 0
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Products request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Services request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“¥ Incoming GET /api/settings/business
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
Total appointments: 0
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
Total receipts: 0
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
âœ… Products found: 0
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/products?limit=1000 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/appointments?limit=5 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Total revenue: 0
âœ… Dashboard stats calculated for business: new ObjectId('6913bc5770f5bc2f8957d21a')
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/reports/dashboard HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Business settings request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
âœ… Services found: 0
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/services?limit=1000 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/settings/payment HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/sales
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
âœ… Business settings found: Glamour Salon & Spa
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/settings/business HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/products
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“¥ Incoming GET /api/appointments
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Sales request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“¥ Incoming GET /api/reports/dashboard
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
âœ… Sales found: 0
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/sales HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Dashboard stats request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Products request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“¥ Incoming GET /api/services
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/appointments?limit=200&date=2025-11-12 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/appointments?limit=500 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Total services: 0
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“¥ Incoming GET /api/sales
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Services request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/appointments?limit=5 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
âœ… Products found: 0
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/products?limit=1000 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Total products: 0
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Sales request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
Total staff: 0
âœ… Services found: 0
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/services?limit=1000 HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
âœ… Sales found: 0
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/sales HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Total clients: 0
ğŸ“¥ Incoming GET /api/sales
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
Total appointments: 0
ğŸ” Auth middleware user: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Auth middleware req.user set: {
  id: new ObjectId('6913bc5770f5bc2f8957d216'),
  email: 'info@gmail.com',
  branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
  role: 'admin'
}
ğŸ” Business DB Middleware Debug: {
  user: {
    id: new ObjectId('6913bc5770f5bc2f8957d216'),
    email: 'info@gmail.com',
    branchId: new ObjectId('6913bc5770f5bc2f8957d21a'),
    role: 'admin'
  },
  businessId: new ObjectId('6913bc5770f5bc2f8957d21a')
}
ğŸ” Getting business connection for ID: new ObjectId('6913bc5770f5bc2f8957d21a')
Total receipts: 0
ğŸ“‹ Found business code: BIZ0002 for ID: 6913bc5770f5bc2f8957d21a
ğŸ” Business connection obtained: true
ğŸ” Creating business models...
ğŸ” Business models created: [
  'Client',
  'Appointment',
  'Sale',
  'Receipt',
  'Product',
  'Service',
  'Staff',
  'CashRegistry',
  'Expense',
  'InventoryTransaction',
  'BusinessSettings',
  'Supplier',
  'Category'
]
âœ… Business database setup complete
ğŸ” Sales request for user: info@gmail.com branchId: new ObjectId('6913bc5770f5bc2f8957d21a')
Total revenue: 0
âœ… Dashboard stats calculated for business: new ObjectId('6913bc5770f5bc2f8957d21a')
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/reports/dashboard HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
âœ… Sales found: 0
127.0.0.1 - - [12/Nov/2025:05:00:42 +0000] "GET /api/sales HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming DELETE /api/admin/businesses/6913bc5770f5bc2f8957d21a
127.0.0.1 - - [12/Nov/2025:05:01:07 +0000] "DELETE /api/admin/businesses/6913bc5770f5bc2f8957d21a HTTP/1.1" 200 78 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/admin/dashboard/stats
127.0.0.1 - - [12/Nov/2025:05:01:07 +0000] "GET /api/admin/dashboard/stats HTTP/1.1" 200 1625 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/admin/profile
127.0.0.1 - - [12/Nov/2025:05:01:28 +0000] "GET /api/admin/profile HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/auth/profile
ğŸ” AuthenticateToken middleware called
ğŸ” JWT decoded successfully: {
  id: '6913bc5770f5bc2f8957d216',
  email: 'info@gmail.com',
  role: 'admin',
  branchId: '6913bc5770f5bc2f8957d21a',
  iat: 1762923639,
  exp: 1763010039
}
ğŸ” User not found in main database, checking if it's a staff user
ğŸ“¥ Incoming GET /api/admin/dashboard/stats
127.0.0.1 - - [12/Nov/2025:05:01:28 +0000] "GET /api/admin/dashboard/stats HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ“¥ Incoming GET /api/admin/dashboard/stats
127.0.0.1 - - [12/Nov/2025:05:01:28 +0000] "GET /api/admin/dashboard/stats HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
ğŸ”— Connecting to business database: salon_crm_6913bc5770f5bc2f8957d21a (legacy by code - backward compatible)
âœ… Connected to business database: salon_crm_6913bc5770f5bc2f8957d21a
ğŸ” User not found in any database for ID: 6913bc5770f5bc2f8957d216
127.0.0.1 - - [12/Nov/2025:05:01:28 +0000] "GET /api/auth/profile HTTP/1.1" 401 42 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
